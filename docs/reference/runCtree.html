<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>run conditional inference tree with additional support — runCtree • citree</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="run conditional inference tree with additional support — runCtree"><meta name="description" content="The partykit::ctree() function only gives the best separation at each node,
i.e. one tree. This wrapper provides the following supports:
By setting recursive = T, all trees meeting p-val cutoff are produced
and saved. Recursion is done by removing the 1st splitting variable from
the df1 and running runCtree() inside runCtree().
The info and stats of each node of each tree are collected and summarized
in an excel file, which also contains ULRs to each tree.
Before running partykit::ctree(), low-informative columns and rows are
removed to reduce computation and adjustment on association p-vals
Cases leading to crashes of partykit::ctree() are handled, e.g. Inf
and -Inf are converted to NA to avoid the following errors:
&quot; 'breaks' are not unique&quot;

"><meta property="og:description" content="The partykit::ctree() function only gives the best separation at each node,
i.e. one tree. This wrapper provides the following supports:
By setting recursive = T, all trees meeting p-val cutoff are produced
and saved. Recursion is done by removing the 1st splitting variable from
the df1 and running runCtree() inside runCtree().
The info and stats of each node of each tree are collected and summarized
in an excel file, which also contains ULRs to each tree.
Before running partykit::ctree(), low-informative columns and rows are
removed to reduce computation and adjustment on association p-vals
Cases leading to crashes of partykit::ctree() are handled, e.g. Inf
and -Inf are converted to NA to avoid the following errors:
&quot; 'breaks' are not unique&quot;

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">citree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/citree-vignette.html">citree-vignette</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/blueskypie/citree/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>run conditional inference tree with additional support</h1>
      <small class="dont-index">Source: <a href="https://github.com/blueskypie/citree/blob/HEAD/R/ctree.funs.r" class="external-link"><code>R/ctree.funs.r</code></a></small>
      <div class="d-none name"><code>runCtree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code><a href="https://rdrr.io/pkg/partykit/man/ctree.html" class="external-link">partykit::ctree()</a></code> function only gives the best separation at each node,
i.e. one tree. This wrapper provides the following supports:</p><ul><li><p>By setting <code>recursive = T</code>, all trees meeting p-val cutoff are produced
and saved. Recursion is done by removing the 1st splitting variable from
the df1 and running <code>runCtree()</code> inside <code>runCtree()</code>.</p></li>
<li><p>The info and stats of each node of each tree are collected and summarized
in an excel file, which also contains ULRs to each tree.</p></li>
<li><p>Before running <code><a href="https://rdrr.io/pkg/partykit/man/ctree.html" class="external-link">partykit::ctree()</a></code>, low-informative columns and rows are
removed to reduce computation and adjustment on association p-vals</p></li>
<li><p>Cases leading to crashes of <code><a href="https://rdrr.io/pkg/partykit/man/ctree.html" class="external-link">partykit::ctree()</a></code> are handled, e.g. <code>Inf</code>
and <code>-Inf</code> are converted to <code>NA</code> to avoid the following errors:
" 'breaks' are not unique"</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">runCtree</span><span class="op">(</span></span>
<span>  <span class="va">df1</span>,</span>
<span>  <span class="va">cohort</span>,</span>
<span>  <span class="va">oDir</span>,</span>
<span>  yi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pCut <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  recursive <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  getReturn <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  ctrlParas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>minsplit <span class="op">=</span> <span class="fl">10</span>, minbucket <span class="op">=</span> <span class="fl">5</span>, maxsurrogate <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="va">pCut</span><span class="op">)</span>,</span>
<span>  naParas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>margins <span class="op">=</span> <span class="fl">1</span>, maxNA.perc <span class="op">=</span> <span class="fl">0.95</span>, minNonNA.count <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  nzvParas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>minUniPerc <span class="op">=</span> <span class="fl">0.05</span>, minUniCount <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  gList <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df-">df1<a class="anchor" aria-label="anchor" href="#arg-df-"></a></dt>
<dd><p>data.frame; columns are variables and rows are observations</p></dd>


<dt id="arg-cohort">cohort<a class="anchor" aria-label="anchor" href="#arg-cohort"></a></dt>
<dd><p>char; name of the observation cohort as an annotation in the drawn tree</p></dd>


<dt id="arg-odir">oDir<a class="anchor" aria-label="anchor" href="#arg-odir"></a></dt>
<dd><p>char; output directory for the tree plot and a summary excel file;</p><ul><li><p>one pdf file for each tree</p></li>
<li><p>each file is named as <code>paste0(oDir,.Platform$file.sep, cohort,'.',yName,'.',gList$counter,'.pdf')</code></p></li>
<li><p>The excel file is the content of <code>stats</code> from the @return (see below), and
is named as <code>paste0(oDir,.Platform$file.sep,cohort,'.xlsx')</code></p></li>
</ul></dd>


<dt id="arg-yi">yi<a class="anchor" aria-label="anchor" href="#arg-yi"></a></dt>
<dd><p>int; index of y variable</p></dd>


<dt id="arg-pcut">pCut<a class="anchor" aria-label="anchor" href="#arg-pcut"></a></dt>
<dd><p>p-val for significant association; not adjusted.</p></dd>


<dt id="arg-recursive">recursive<a class="anchor" aria-label="anchor" href="#arg-recursive"></a></dt>
<dd><p>logical;</p><ul><li><p>F: only produce the best tree</p></li>
<li><p>T: produce all trees meeting <code>pCut</code></p></li>
</ul></dd>


<dt id="arg-getreturn">getReturn<a class="anchor" aria-label="anchor" href="#arg-getreturn"></a></dt>
<dd><p>logical; if T, return a list below; no returns otherwise.
it's also used to reduce the internal data transfer load if <code>recursive = T</code>.</p></dd>


<dt id="arg-ctrlparas">ctrlParas<a class="anchor" aria-label="anchor" href="#arg-ctrlparas"></a></dt>
<dd><p>list; parameters for <code><a href="https://rdrr.io/pkg/partykit/man/ctree_control.html" class="external-link">partykit::ctree_control()</a></code></p></dd>


<dt id="arg-naparas">naParas<a class="anchor" aria-label="anchor" href="#arg-naparas"></a></dt>
<dd><p>list; parameters for <code><a href="rmNA.html">rmNA()</a></code></p></dd>


<dt id="arg-nzvparas">nzvParas<a class="anchor" aria-label="anchor" href="#arg-nzvparas"></a></dt>
<dd><p>list; parameters for <code><a href="rmNZV.html">rmNZV()</a></code></p></dd>


<dt id="arg-glist">gList<a class="anchor" aria-label="anchor" href="#arg-glist"></a></dt>
<dd><p>a listenv list; it's for internal recursion tracking; users
should ignore this argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>if <code>getReturn</code>, a list of following items; none otherwise.</p><ul><li><p><code>df</code>: cleaned df1; NA if df1 has only one column or &lt; 10 rows with y values.</p></li>
<li><p><code>stats</code>: possible values:</p><ul><li><p>NA <code>ctree()</code> doesn't run due to one of the following reasons:</p><ul><li><p>only one column in <code>df1</code></p></li>
<li><p>&lt; 10 rows where y is not NA</p></li>
<li><p>y has low variance and is removed by <code><a href="rmNZV.html">rmNZV()</a></code></p></li>
<li><p>no tree fitting the <code>pCut</code> is found. In this case, try increasing <code>pCut</code></p></li>
</ul></li>
<li><p>A data.frame of following columns, one tree per row</p><ul><li><p>counter: the index of each tree drawing</p></li>
<li><p>cohort, y, pCutoff</p></li>
<li><p>spVar1,pVal1: the name and p-val of the splitting variable at node 1</p></li>
<li><p>nNode: number of nodes of the tree</p></li>
<li><p>spVars: a string containing the names and stats of all splitting
variables. for each node, the format is "name,p-val,cut,gtOnRight"
nodes are separated by ';'.</p></li>
<li><p>plot: the path to the tree plot</p></li>
</ul></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note:</p><ul><li><p>packages <code>partykit</code> and <code>openxlsx</code> are loaded, but not attached, in this function.</p></li>
<li><p>ctree uses <code><a href="https://rdrr.io/pkg/coin/man/IndependenceTest.html" class="external-link">coin::independence_test()</a></code> to test the association of two
variables of any data type. See <a href="https://cran.r-project.org/web/packages/coin/vignettes/LegoCondInf.pdf" class="external-link">here</a>
for theory behind the test, and <a href="https://stats.stackexchange.com/questions/404589/ctree-in-r-how-optimal-is-the-optimal-split-point" class="external-link">here</a>
for an explanation of the algorithm.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># none</span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jike Cui.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

